\section{Неограниченный MPC}\label{chap3}

Неограниченный MPC ставит перед собой задачу гарантировать стабильность и оценить на сколько управление MPC отличается от оптимального. ЗДесь нет ограничений на состояния, поэтому терминальные ингредиенты не вводятся.

Постановка задачи: 
\begin{itemize}
\item Система строится на основе динамики $\dot x = f(x,u), x(0)=x_0, \ x \in \mathbb{R}^n$
\item Ограничения вводятся на управление $u(t) \in \mathbb{U} \subseteq \mathbb{R}^m \ \forall t \geq 0$
\end{itemize}

Функция стоимости на бесконечном горизонте
\begin{equation*}
J_{\infty}(x_0, \bar{u}(\cdot; 0)) = \int_{0}^{\infty}L(\bar x(\tau;0), \bar u(\tau;0))d\tau
\end{equation*}
$\Rightarrow$ оптимальное значение функции $J_{\infty}^*(x_0)$

Предположение: Если $J^{*}_{\infty}(x_0) < \infty, \forall x_0$, тогда система асимптотически стабильна.

Функция стоимости на конечном горизонте:
\begin{equation*}
J_{T}(x(t), \bar{u}(\cdot; t)) = \int_{0}^{T}L(\bar x(\tau;t), \bar u(\tau;t))d\tau
\end{equation*}

Функцию стоимости на бесконечном горизонте получаем,
как результат применения MPC
\begin{equation*}
J_{\infty}^{MPC}(x_0) = \int_{0}^{\infty}L(\bar x_{MPC}(\tau), \bar u_{MPC}(\tau))d\tau
\end{equation*}

Индекс субоптимальности $\alpha$:

$\alpha J_{\infty}^{MPC}(x_0) \leq J_{\infty}^{*}(x_0) \ \forall x_0$

\begin{itemize}
\item $\alpha \leq 1$ следует из оптимальности $J^{*}_{\infty}$
\item $\alpha > 0$ дает стабильность замнкнутой сиистемы
\end{itemize}
 
Предположим, что существует $\alpha \in (0,1]$ такое что $\forall x \in \mathbb{R}^n$

\begin{equation}\label{sub_opt_ineq}
J_{T}^{*}(x(t+\delta)) \leq J_T^*(x(t)) - \alpha\int_{t}^{t+\delta}L(\bar x^*(\tau;t),\bar u^*(\tau;t))d\tau 
\end{equation}

Тогда для всех $x \in \mathbb{R}^n$ верна следующая цепочка неравенств 
\begin{equation*}
\alpha J_{\infty}^*(x(t)) \leq \alpha J_{\infty}^{MPC}(x(t)) \leq J_T^*(x(t)) \leq J_{\infty}^*(x(t))
\end{equation*}

Введем обозначение оптимальной функции стоимости перехода
$L^*(t;t) = L(\bar x^*(\tau;t), \bar u^*(\tau;t))$

Рассмотрим следующие два неравенства:

\begin{equation}\label{c_b_inequality}
J_T^*(x(t+\delta)) \leq \frac{1}{\epsilon} \int_{t+\delta}^{t+T}L^*(\tau;t)d\tau 
\end{equation}
\begin{equation}\label{b_a_inequality}
\int_{t+\delta}^{t+T}L^*(\tau;t)d\tau \leq \gamma \int_{t}^{t+\delta}L^*(\tau;t)d\tau 
\end{equation} 

\begin{theorem}

Предположим, что существуют $\epsilon \in (0;1]$ и $\gamma > 0$ такие что \ref{c_b_inequality} - \ref{b_a_inequality} выполняется. Тогда (\ref{sub_opt_ineq}) выполняется
при $\alpha =1 - \gamma \frac{1-\epsilon}{\epsilon}$
\begin{equation*}
J_T^*(x(t+\delta)) - J_T^*(x(t)) = J_T^*(x(t+\delta)) - \int_{t}^{t+T}L^*(\tau;t)d\tau \leq^{(\ref{c_b_inequality})}
\end{equation*}
\begin{equation*}
\leq \frac{1-\epsilon}{\epsilon} \int_{t+\delta}^{t+T}L^*(\tau;t)d\tau - \int_t^{t+\delta}L^*(\tau;t)d\tau \leq^{(\ref{b_a_inequality})}
\end{equation*}
\begin{equation*}
\leq (\gamma \frac{1-\epsilon}{\epsilon} - 1) \int_t^{t+\delta}L^*(\tau;t)d\tau
\end{equation*} 
Тогда сейчас мы можем обозначить
$\alpha := 1 - \gamma \frac{1-\epsilon}{\epsilon}$ и получить неравенство (\ref{sub_opt_ineq}).
\end{theorem}

Предположение 1: Асимптотическая управляемость

Для всех $x$, существует некое управление $\hat u_x(\cdot)$, 
удовлетворяющее $\hat u_x(t) \in \mathbb{U},\ \forall t \geq 0$ такое что
\begin{equation*}
L(\hat x(t),\hat u(t)) \leq \beta(t) \min_u L(x,u), \ \forall t > 0
\end{equation*}
где $\beta: \mathbb{R} \to \mathbb{R}_{\geq 0}$
 - непрерывная, положительная, строго убывающая и $\lim_{t \to 0} \beta(t) = 0$ 

$\Rightarrow$ из этого следует, что
$\int_0^{\infty}\beta(\tau)d\tau < \infty$, а тогда обозначим этот интеграл как
$B(t) = \int_0^t\beta(\tau)d\tau$.

Необходимо показать,как найти  $\epsilon$ и $\gamma$:

\begin{Lemma} 
Пусть предположение 1 выполняется. Тогда неравенство 
\begin{equation*}
J_T^*(x(t+\delta)) \leq \int_{t+\delta}^{t+t'}L^*(\tau;t)d\tau + B(T+\delta - t')L^*(t+t';t)
\end{equation*}
верно для всех $t' \in [\delta,T]$
\end{Lemma}

Основываясь на предыдыщей лемме, найдем чему равно $\epsilon$:

\begin{equation*}
J^*_T(x(t+\delta)) \leq \min_{t' \in [\delta,T]}(\int_{t+\delta}^{t+t'}L^*(\tau;t)d\tau + B(T+\delta-t')L^*(t+t';t)) \leq
\end{equation*}
\begin{equation*}
\int_{t+\delta}^{t+T}L^*(\tau;t)d\tau + B(T) \min_{t'\in[\delta,T]}L^*(t+t';t)
\end{equation*}
так как
$\min_{t'\in[\delta,T]}L^*(t+t';t) \leq \frac{1}{T-\delta}\int_{t+\delta}^{t+T}L^*(\tau;t)d\tau$
минимум менее или равен среднему значению, получим
\begin{equation*}
=(1+\frac{B(T)}{T-\delta})\int_{t+\delta}^{t+T}L^*(\tau;t)d\tau
\end{equation*}
А тогда мы имеем
$(1+\frac{B(T)}{T-\delta}) = \frac{1}{\epsilon}$, т.е. $\frac{1-\epsilon}{\epsilon} = \frac{B(T)}{T-\delta}$.

Аналогичным способом найдем, чему равно $\gamma$.
\begin{Lemma}
Пусть предположение 1 выполняется. Тогда неравенство 
\begin{equation*}
\int_{t+t'}^{t+T}L^*(\tau;t)d\tau \leq B(T-t')L^*(t+t';t)
\end{equation*}
верно для всех $t' \in [0;T]$
\end{Lemma}

Тем же способом как и получили $\epsilon$, найдем $\gamma = \frac{B(T)}{\delta}$ с помощью предыдущей леммы. 

В результате получим $\alpha = 1 - \gamma \frac{1-\epsilon}{\epsilon} = 1 - \frac{B(T)}{\delta}(\frac{B(T)}{T-\delta})$.

При $ T \to \infty $ наша оценка для $ \epsilon \to 1$, а значит из этого следует $\alpha \to 1$ при $ T \to \infty$, тогда из этого будет следовать замкнутая стабильность при достаточно большом $T$.
