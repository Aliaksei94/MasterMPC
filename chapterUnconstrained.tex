\section{Безусловный MPC}\label{chap3}

Теория безусловного MPC  (Unconstrained MPC) (см. например, \cite{Grune, GrunePannek}) ставит перед собой задачу гарантировать асимптотическую устойчивость замкнутой системы без дополнительных терминальных ингредиентов (терминальная функция $F$ и терминальное множество $X^f$). Помимо упрощения предварительных построений, связанных с вычислением $F$ и $X^f$, и численного решения прогнозирующей задачи оптимального управления $\bar P(x(t))$, теория безусловного МРС позволяет оценить, насколько управление MPC отличается от оптимального, т.е. от решения задачи (\ref{1stab_problem}).

Задача МРС в рассматриваемом случае имеет вид
\begin{equation}\label{1mpc_unc}
J_{T}(x(t), \bar{u}(\cdot; t)) = \int_{t}^{t+T}L(\bar x(\tau;t), \bar u(\tau;t))d\tau,
\end{equation}
при условиях
$$
    \dot{\bar x} = f(\bar x,\bar u), \ \ \bar x(t;t) = x(t),
    $$
$$
    \bar u(\tau;t) \in U, \ \
    \tau \in [t, t +T].
    $$

В результате применения базового алгоритма МРС c прогнозирующей задачей оптимального управления (\ref{1mpc_unc}) на бесконечном полуинтервале $[0, \infty)$ будет получена следующая стоимость процесса МРС:
\begin{equation*}
J_{\infty}^{MPC}(x_0) = \int_{0}^{\infty}L(x_{MPC}(\tau), u_{MPC}(\tau))d\tau.
\end{equation*}

Дальнейшая цель --- найти оценку субоптимальности $\alpha$:
$$  
    \alpha J_{\infty}^{MPC}(x_0) \leq J_{\infty}^{*}(x_0) \ \ \forall x_0,
    $$
где для $\alpha$ выполнены неравенства 
\begin{itemize}
\item[---] $\alpha \leq 1$, что следует из оптимальности значения $J^{*}_{\infty}(x_0)$;
\item[---] $\alpha > 0$, что требуется для гарантии асимптотической устойчивости замкнутой системы (см. доказательство теоремы~\ref{1Th:Stability}).
\end{itemize}

Предположим, что существует $\alpha \in (0,1]$, такое что $\forall x \in \mathbb{R}^n$ выполняется
\begin{equation}\label{sub_opt_ineq}
J_{T}^{*}(x(t+\delta)) \leq J_T^*(x(t)) - \alpha\int_{t}^{t+\delta}L(\bar x^*(\tau;t),\bar u^*(\tau;t))d\tau.
\end{equation}
Тогда для всех $x \in \mathbb{R}^n$ верна следующая цепочка неравенств
\begin{equation*}
\alpha J_{\infty}^*(x(t)) \leq \alpha J_{\infty}^{MPC}(x(t)) \leq J_T^*(x(t)) \leq J_{\infty}^*(x(t)).
\end{equation*}

\begin{theorem}
Предположим, что существуют $\epsilon \in (0;1]$ и $\gamma > 0$, такие что выполняются неравенства
\begin{equation}\label{c_b_inequality}
J_T^*(x(t+\delta)) \leq \frac{1}{\epsilon} \int_{t+\delta}^{t+T}L^*(\tau;t)d\tau,
\end{equation}
\begin{equation}\label{b_a_inequality}
\int_{t+\delta}^{t+T}L^*(\tau;t)d\tau \leq \gamma \int_{t}^{t+\delta}L^*(\tau;t)d\tau,
\end{equation}
где $L^*(\tau;t) = L(\bar x^*(\tau;t), \bar u^*(\tau;t))$. 

Тогда (\ref{sub_opt_ineq}) выполняется
при $\alpha =1 - \gamma \frac{1-\epsilon}{\epsilon}$.
\end{theorem}

\proof следует из цепочки неравенств
\begin{equation*}
J_T^*(x(t+\delta)) - J_T^*(x(t)) = J_T^*(x(t+\delta)) - \int_{t}^{t+T}L^*(\tau;t)d\tau {(\ref{c_b_inequality}) \atop \leq}
\end{equation*}
\begin{equation*}
\leq \frac{1-\epsilon}{\epsilon} \int_{t+\delta}^{t+T}L^*(\tau;t)d\tau - \int_t^{t+\delta}L^*(\tau;t)d\tau {(\ref{b_a_inequality}) \atop \leq}
\end{equation*}
\begin{equation*}
\leq (\gamma \frac{1-\epsilon}{\epsilon} - 1) \int_t^{t+\delta}L^*(\tau;t)d\tau
\end{equation*}
Обозначим $\alpha := 1 - \gamma \frac{1-\epsilon}{\epsilon}$, получим требуемое неравенство (\ref{sub_opt_ineq}). \proofend

Дальнейшие построения направлены на нахождение подходящих $\varepsilon$, $\gamma$.

\begin{assumption}\label{1Ass:Asympt_controllability} (Асимптотическая управляемость) Для всех $x$, существует управление $\hat u_x(t) \in U$,  $t \geq 0$, такое что
\begin{equation*}
L(\hat x(t),\hat u(t)) \leq \beta(t) \min_u L(x,u), \ \ t > 0,
\end{equation*}
где $\beta: \mathbb{R} \to \mathbb{R}_{\geq 0}$ --- непрерывная, положительная, строго убывающая и $\lim_{t \to 0} \beta(t) = 0$. 
\end{assumption}

Из условий, накладываемых на функцию $\beta$  следует, что
$\int_0^{\infty}\beta(\tau)d\tau < \infty$. Далее будем использовать обозначение
$B(t) = \int_0^t\beta(\tau)d\tau$.

\begin{lemma}\label{1lem:unc_1}
В предположении~\ref{1Ass:Asympt_controllability} неравенство
\begin{equation*}
J_T^*(x(t+\delta)) \leq \int_{t+\delta}^{t+t'}L^*(\tau;t)d\tau + B(T+\delta - t')L^*(t+t';t)
\end{equation*}
верно для всех $t' \in [\delta,T]$.
\end{lemma}

Основываясь на  лемме \ref{1lem:unc_1}, найдем значение $\epsilon$. Запишем неравенство
$$
    J^*_T(x(t+\delta))  \leq \min_{t' \in [\delta,T]} \left\{\int_{t+\delta}^{t+t'}L^*(\tau;t)d\tau + B(T+\delta-t')L^*(t+t';t) \right\}  \leq
    $$
$$
     \le \int_{t+\delta}^{t+T}L^*(\tau;t)d\tau + B(T) \min_{t'\in[\delta,T]}L^*(t+t';t) = 
     \left(1+\frac{B(T)}{T-\delta}\right)\int_{t+\delta}^{t+T}L^*(\tau;t)d\tau,
    $$
где использовано неравенство $\min_{t'\in[\delta,T]}L^*(t+t';t) \leq \frac{1}{T-\delta}\int_{t+\delta}^{t+T}L^*(\tau;t)d\tau$.

Тогда мы имеем
$\left(1+\frac{B(T)}{T-\delta}\right) = \frac{1}{\epsilon}$, т.е. $\frac{1-\epsilon}{\epsilon} = \frac{B(T)}{T-\delta}$.

Аналогично найдем, чему равно $\gamma$. Будем использовать 
\begin{lemma}\label{1lem:unc_2}
В предположении \ref{1Ass:Asympt_controllability} неравенство
\begin{equation*}
\int_{t+t'}^{t+T}L^*(\tau;t)d\tau \leq B(T-t')L^*(t+t';t)
\end{equation*}
верно для всех $t' \in [0;T]$.
\end{lemma}

Повторяя аргументы, с помощью которых было получено $\varepsilon$, используя лемму \ref{1lem:unc_2} найдем $\gamma = \frac{B(T)}{\delta}$.

Окончательно, получили 
$$
    \alpha = 1 - \gamma \frac{1-\epsilon}{\epsilon} = 1 - \frac{B(T)}{\delta}\left(\frac{B(T)}{T-\delta}\right),
    $$
откуда следует, что при $ T \to \infty $, поскольку  $ \epsilon \to 1$, то $\alpha \to 1$. Таким образом, при достаточно больших горизонтах прогнозирования имеет место асимптотическая устойчивость замкнутой системы и субоптимальность полученной в результате применения алгоритма МРС обратной связи.
